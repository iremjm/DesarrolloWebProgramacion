package model;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.ObjectInputStream;
import java.io.ObjectOutputStream;
import java.util.ArrayList;

import notas.model.Alumno;

public class GestorAlumnos {
	private static final String FICHERO_LISTADO=".\\listado.ser";//Cargar los datos del fichero
	private ArrayList<Alumno> lstAlumnos=new ArrayList<Alumno>();//el arraylist no tiene tamaño fijo,se modifica internamente.
	public GestorAlumnos(){
		leerListado();
		
	}
	public void leerListado(){

		//método que lee del fichero los datos de los alumnos
			FileInputStream fin = null;
			ObjectInputStream ois = null;

			try {
				//puede que no exista el fichero
				fin = new FileInputStream(FICHERO_LISTADO);
				ois = new ObjectInputStream(fin);
				lstAlumnos = (ArrayList<Alumno>) ois.readObject();

			}catch (FileNotFoundException fnfe){
				//no eiste el fichero,porque no se han
				//introducido datos...
			}
			catch (Exception ex) {
				ex.printStackTrace();
			} finally {

				if (fin != null) {
					try {
						fin.close();
					} catch (IOException e) {
						e.printStackTrace();
					}
				}

				if (ois != null) {
					try {
						ois.close();
					} catch (IOException e) {
						e.printStackTrace();
					}
				}

			}
		}

	
	public void guardarListado(){
	//método que guarda en un fichero los datos de los alumnos
		FileOutputStream fout=null;
		ObjectOutputStream oos=null;
		try {
			fout = new FileOutputStream(FICHERO_LISTADO);
			oos = new ObjectOutputStream(fout);
			oos.writeObject(lstAlumnos);
			
		} catch (FileNotFoundException e) {
			// TODO Auto-generated catch block
			System.out.println("Fichero no encontrado!!");
		} catch (IOException e) {
			// TODO Auto-generated catch block
			
			System.out.println("Error de escritura");
		}		
		finally {

			if (fout != null) {
				try {
					fout.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}

			if (oos != null) {
				try {
					oos.close();
				} catch (IOException e) {
					e.printStackTrace();
				}
			}

		}
	}

	public void addAlumno(Alumno a){
		lstAlumnos.add(a);
			}
	//Eliminar alumno
	public void delAlumno(int index){//elimina el objeto que se encuentra en el indice
		lstAlumnos.remove(index);
	}
	public void delAlumno(Alumno al){
		lstAlumnos.remove(al);
	}
	//modificar alumno
	public void modAlumno(int index, Alumno al){
		lstAlumnos.set(index, al);
	}
	//Contar cuantos alumnos hay
	public int getCantidadAlumnos(){
		
		return lstAlumnos.size();
	}
	//Buscar un alumno
	Alumno getAlumno(String nombre){
		  for(int i = 0 ; i < lstAlumnos.size();i++) {
	            if(lstAlumnos.get(i).visibile != false) {//Muestra el alumno
	            } else {
	                System.out.println("El alumno no existe"); 
		return null;
	}
	Alumno getAlumno(int index){
		return lstAlumnos.get(index);
	}
	
}
